{% extends "base.html" %}
{% load static %}

{% block title %}{{ profile_user.username }}'s Profile - PromptFlow{% endblock %}

{% block content %}
<style>
/* Avatar System - 8 Hash-Based Gradient Colors */
.profile-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 48px;
    font-weight: 700;
    color: white;
    text-transform: uppercase;
    border: 4px solid white;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.profile-avatar-small {
    width: 40px;
    height: 40px;
    font-size: 16px;
    border: 2px solid white;
}

/* 8 Gradient Color Classes (WCAG AA Compliant) */
.avatar-color-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.avatar-color-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
.avatar-color-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
.avatar-color-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
.avatar-color-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
.avatar-color-6 { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); }
.avatar-color-7 { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #333; }
.avatar-color-8 { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); color: #333; }

/* Profile Header */
.profile-header {
    background: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 40px 0 0;
    margin-bottom: 24px;
}

.profile-info {
    display: flex;
    align-items: flex-start;
    gap: 24px;
    margin-bottom: 24px;
    padding: 0 40px;
}

.profile-details {
    flex: 1;
}

.profile-username {
    font-size: 32px;
    font-weight: 700;
    margin: 0 0 8px;
    color: #1f2937;
}

.profile-bio {
    font-size: 16px;
    color: #6b7280;
    margin: 0 0 16px;
    line-height: 1.5;
}

.profile-social-links {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
}

.social-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: #3b82f6;
    text-decoration: none;
    font-size: 14px;
}

.social-link:hover {
    color: #2563eb;
    text-decoration: underline;
}

.profile-stats {
    display: flex;
    gap: 32px;
    padding: 0 40px 20px;
    border-bottom: 1px solid #e5e7eb;
}

.stat-item {
    display: flex;
    flex-direction: column;
}

.stat-value {
    font-size: 24px;
    font-weight: 700;
    color: #1f2937;
}

.stat-label {
    font-size: 14px;
    color: #6b7280;
}

/* Media Filter Tabs */
.media-filter-tabs {
    display: flex;
    gap: 0;
    padding: 0 40px;
    background: white;
}

.media-tab {
    padding: 12px 24px;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    color: #6b7280;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
}

.media-tab:hover {
    color: #1f2937;
    background: #f9fafb;
}

.media-tab.active {
    color: #3b82f6;
    border-bottom-color: #3b82f6;
}

/* Empty State */
.empty-profile {
    text-align: center;
    padding: 80px 20px;
}

.empty-profile i {
    font-size: 64px;
    color: #d1d5db;
    margin-bottom: 16px;
}

.empty-profile h3 {
    font-size: 24px;
    color: #6b7280;
    margin-bottom: 8px;
}

.empty-profile p {
    font-size: 16px;
    color: #9ca3af;
}

/* Responsive Breakpoints */
@media (max-width: 768px) {
    .profile-info {
        flex-direction: column;
        text-align: center;
        padding: 0 20px;
    }

    .profile-avatar {
        margin: 0 auto;
    }

    .profile-social-links {
        justify-content: center;
    }

    .profile-stats {
        padding: 0 20px 20px;
        gap: 16px;
    }

    .stat-item {
        flex: 1;
        text-align: center;
    }

    .media-filter-tabs {
        padding: 0 20px;
    }

    .media-tab {
        flex: 1;
        padding: 12px 8px;
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .profile-username {
        font-size: 24px;
    }

    .stat-value {
        font-size: 20px;
    }

    .stat-label {
        font-size: 12px;
    }
}
</style>

<!-- Profile Header -->
<div class="profile-header">
    <div class="profile-info">
        <!-- Avatar -->
        {% if profile.avatar %}
            <img src="{{ profile.avatar.url }}" alt="{{ profile_user.username }}'s avatar" class="profile-avatar">
        {% else %}
            <div class="profile-avatar avatar-color-{{ profile.get_avatar_color_index }}" aria-label="{{ profile_user.username }}'s default avatar">
                {{ profile_user.username|slice:":1" }}
            </div>
        {% endif %}

        <!-- User Info -->
        <div class="profile-details">
            <h1 class="profile-username">{{ profile_user.username }}</h1>

            {% if profile.bio %}
                <p class="profile-bio">{{ profile.bio }}</p>
            {% endif %}

            <!-- Social Links -->
            {% if profile.twitter_url or profile.instagram_url or profile.website_url %}
                <div class="profile-social-links">
                    {% if profile.twitter_url %}
                        <a href="{{ profile.twitter_url }}" class="social-link" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-twitter"></i> Twitter
                        </a>
                    {% endif %}
                    {% if profile.instagram_url %}
                        <a href="{{ profile.instagram_url }}" class="social-link" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-instagram"></i> Instagram
                        </a>
                    {% endif %}
                    {% if profile.website_url %}
                        <a href="{{ profile.website_url }}" class="social-link" target="_blank" rel="noopener noreferrer">
                            <i class="fas fa-link"></i> Website
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Stats Row -->
    <div class="profile-stats">
        <div class="stat-item">
            <span class="stat-value">{{ total_prompts }}</span>
            <span class="stat-label">Prompts</span>
        </div>
        <div class="stat-item">
            <span class="stat-value">{{ total_likes }}</span>
            <span class="stat-label">Likes</span>
        </div>
    </div>

    <!-- Media Filter Tabs -->
    <div class="media-filter-tabs" role="tablist" aria-label="Filter prompts by media type">
        <a href="{% url 'prompts:user_profile' profile_user.username %}?media=all"
           class="media-tab {% if media_filter == 'all' %}active{% endif %}"
           role="tab"
           aria-selected="{% if media_filter == 'all' %}true{% else %}false{% endif %}">
            All
        </a>
        <a href="{% url 'prompts:user_profile' profile_user.username %}?media=photos"
           class="media-tab {% if media_filter == 'photos' %}active{% endif %}"
           role="tab"
           aria-selected="{% if media_filter == 'photos' %}true{% else %}false{% endif %}">
            <i class="fas fa-image"></i> Photos
        </a>
        <a href="{% url 'prompts:user_profile' profile_user.username %}?media=videos"
           class="media-tab {% if media_filter == 'videos' %}active{% endif %}"
           role="tab"
           aria-selected="{% if media_filter == 'videos' %}true{% else %}false{% endif %}">
            <i class="fas fa-video"></i> Videos
        </a>
    </div>
</div>

<!-- Masonry Grid (Reusable Partial) -->
{% if prompts %}
    {% include 'prompts/partials/_masonry_grid.html' with items=prompts grid_id='profile-grid' show_load_more=True page_obj=page_obj %}
{% else %}
    <!-- Empty State -->
    <div class="empty-profile">
        <i class="fas fa-image"></i>
        <h3>No {% if media_filter == 'photos' %}photos{% elif media_filter == 'videos' %}videos{% else %}prompts{% endif %} yet</h3>
        <p>
            {% if is_owner %}
                Start sharing your creations!
            {% else %}
                {{ profile_user.username }} hasn't shared any {% if media_filter == 'photos' %}photos{% elif media_filter == 'videos' %}videos{% else %}prompts{% endif %} yet.
            {% endif %}
        </p>
    </div>
{% endif %}

{% endblock %}
